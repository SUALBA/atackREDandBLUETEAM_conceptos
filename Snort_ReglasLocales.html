<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ›¡ï¸ Reglas Locales de Snort</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
</head>
<body class="bg-gray-900 text-gray-200 font-sans">
  <header class="bg-gradient-to-r from-purple-600 to-blue-600 p-6 text-center shadow-lg">
    <h1 class="text-4xl font-bold">ğŸ›¡ï¸ Reglas Locales de Snort: Defensa con Estilo ğŸš€</h1>
    <p class="mt-2 text-lg">GuÃ­a visual e intuitiva para detectar ataques comunes</p>
  </header>

  <main class="max-w-4xl mx-auto p-6 space-y-6">

    <!-- Plantilla de regla -->
    <div class="bg-gray-800 rounded-2xl shadow-md p-6">
      <h2 class="text-2xl font-bold text-purple-400 flex items-center gap-2">
        <i class="ph ph-magnifying-glass"></i> Regla 1: Detectar escaneo Nmap ğŸ•µï¸
      </h2>
      <pre class="bg-gray-900 p-4 rounded-lg overflow-x-auto text-green-400 mt-3">
alert tcp any any -> $HOME_NET any 
(msg: "NMAP Scan Detected"; sid:1000001; flags:S; 
threshold:type threshold, track by_dst, count 5, seconds 60)</pre>
      <button onclick="toggleInfo(this)" class="mt-3 bg-purple-500 hover:bg-purple-700 px-4 py-2 rounded text-sm">
        Ver explicaciÃ³n
      </button>
      <div class="hidden mt-3 text-gray-300 space-y-2">
        <p>ğŸ“– <b>ExplicaciÃ³n:</b> Detecta mÃºltiples paquetes SYN â†’ tÃ­pico de Nmap.</p>
        <p>âš¡ <b>Consecuencias:</b> Un atacante mapea tus servicios, primer paso de intrusiÃ³n.</p>
        <p>ğŸ¯ <b>ConclusiÃ³n:</b> Verifica servicios expuestos y aplica firewall + IDS.</p>
      </div>
    </div>

    <!-- Regla 2 -->
    <div class="bg-gray-800 rounded-2xl shadow-md p-6">
      <h2 class="text-2xl font-bold text-blue-400 flex items-center gap-2">
        <i class="ph ph-folder-simple"></i> Regla 2: Acceso a .git expuesto ğŸ”‘
      </h2>
      <pre class="bg-gray-900 p-4 rounded-lg overflow-x-auto text-green-400 mt-3">
alert tcp any any -> $HOME_NET 80 
(msg:"Access to hidden folder"; sid:1000002; 
content:"/.git/"; http_uri; classtype:web-application-attack;)</pre>
      <button onclick="toggleInfo(this)" class="mt-3 bg-blue-500 hover:bg-blue-700 px-4 py-2 rounded text-sm">
        Ver explicaciÃ³n
      </button>
      <div class="hidden mt-3 text-gray-300 space-y-2">
        <p>ğŸ“– Busca accesos a la carpeta <b>.git/</b> expuesta.</p>
        <p>âš¡ Riesgo de robo de <b>cÃ³digo fuente, contraseÃ±as y configuraciones.</b></p>
        <p>ğŸ¯ Bloquea siempre <b>.git</b> con .htaccess o Nginx.</p>
      </div>
    </div>

    <!-- Regla 3 -->
    <div class="bg-gray-800 rounded-2xl shadow-md p-6">
      <h2 class="text-2xl font-bold text-red-400 flex items-center gap-2">
        <i class="ph ph-lock-simple"></i> Regla 3: Login FTP anÃ³nimo ğŸš¨
      </h2>
      <pre class="bg-gray-900 p-4 rounded-lg overflow-x-auto text-green-400 mt-3">
alert tcp any any -> $HOME_NET 21 
(msg:"Anonymous FTP access"; content:"USER anonymous"; 
classtype:suspicious-login; sid:10000003; rev:1;)</pre>
      <button onclick="toggleInfo(this)" class="mt-3 bg-red-500 hover:bg-red-700 px-4 py-2 rounded text-sm">
        Ver explicaciÃ³n
      </button>
      <div class="hidden mt-3 text-gray-300 space-y-2">
        <p>ğŸ“– Detecta login FTP con usuario <b>anonymous</b>.</p>
        <p>âš¡ Riesgo de descarga o subida no autorizada.</p>
        <p>ğŸ¯ Usa <b>SFTP</b> o usuarios autenticados, nunca FTP anÃ³nimo.</p>
      </div>
    </div>

    <!-- Regla 3b -->
    <div class="bg-gray-800 rounded-2xl shadow-md p-6">
      <h2 class="text-2xl font-bold text-orange-400 flex items-center gap-2">
        <i class="ph ph-upload-simple"></i> Regla 3b: Subida de archivos por FTP ğŸ’¾
      </h2>
      <pre class="bg-gray-900 p-4 rounded-lg overflow-x-auto text-green-400 mt-3">
alert tcp any any -> $HOME_NET 21 
(msg:"Try to upload a file"; content:"STOR"; sid:1000006;)</pre>
      <button onclick="toggleInfo(this)" class="mt-3 bg-orange-500 hover:bg-orange-700 px-4 py-2 rounded text-sm">
        Ver explicaciÃ³n
      </button>
      <div class="hidden mt-3 text-gray-300 space-y-2">
        <p>ğŸ“– Detecta comando <b>STOR</b> (subida FTP).</p>
        <p>âš¡ Riesgo de webshells o malware.</p>
        <p>ğŸ¯ Desactiva subida si no es necesaria, monitorea actividad.</p>
      </div>
    </div>

    <!-- Regla 4 -->
    <div class="bg-gray-800 rounded-2xl shadow-md p-6">
      <h2 class="text-2xl font-bold text-green-400 flex items-center gap-2">
        <i class="ph ph-terminal-window"></i> Regla 4: Fuerza Bruta SSH ğŸ”
      </h2>
      <pre class="bg-gray-900 p-4 rounded-lg overflow-x-auto text-green-400 mt-3">
alert tcp any any -> $HOME_NET 22 
(msg:"Potential SSH Brute Force"; sid:1000004; flow:to_server; flags:S; 
detection_filter:track by_src, count 2, seconds 60; classtype:attempted-dos;)</pre>
      <button onclick="toggleInfo(this)" class="mt-3 bg-green-500 hover:bg-green-700 px-4 py-2 rounded text-sm">
        Ver explicaciÃ³n
      </button>
      <div class="hidden mt-3 text-gray-300 space-y-2">
        <p>ğŸ“– Detecta mÃºltiples intentos SSH desde una IP.</p>
        <p>âš¡ Indica fuerza bruta â†’ riesgo de acceso no autorizado.</p>
        <p>ğŸ¯ Usa <b>fail2ban</b> o bloqueos automÃ¡ticos.</p>
      </div>
    </div>

    <!-- Regla 5 -->
    <div class="bg-gray-800 rounded-2xl shadow-md p-6">
      <h2 class="text-2xl font-bold text-yellow-400 flex items-center gap-2">
        <i class="ph ph-warning"></i> Regla 5: InyecciÃ³n de comandos en puerto 5011 âš”ï¸
      </h2>
      <pre class="bg-gray-900 p-4 rounded-lg overflow-x-auto text-green-400 mt-3">
alert tcp any any -> any 5011 
(msg:"Posible inyecciÃ³n de comandos por el puerto 5011"; 
content:"|3B|"; sid:1000008;)</pre>
      <button onclick="toggleInfo(this)" class="mt-3 bg-yellow-500 hover:bg-yellow-700 px-4 py-2 rounded text-sm">
        Ver explicaciÃ³n
      </button>
      <div class="hidden mt-3 text-gray-300 space-y-2">
        <p>ğŸ“– Busca el carÃ¡cter <b>;</b> usado en inyecciones.</p>
        <p>âš¡ Permite ejecutar mÃºltiples comandos.</p>
        <p>ğŸ¯ Escapa entradas y audita servicios en el puerto 5011.</p>
      </div>
    </div>

    <!-- ReflexiÃ³n final -->
    <div class="bg-gradient-to-r from-purple-700 to-blue-700 rounded-2xl p-6 shadow-lg text-center">
      <h2 class="text-3xl font-bold mb-3">ğŸŒˆ Reflexiones Finales</h2>
      <p>Estas reglas convierten tu IDS en un <b>perro guardiÃ¡n digital ğŸ•â€ğŸ¦º</b>.</p>
      <p class="mt-2">Detectan escaneos, accesos indebidos y ataques comunes, dÃ¡ndote tiempo de <b>reaccionar antes del daÃ±o real</b>.</p>
    </div>

  </main>

  <script>
    function toggleInfo(button) {
      const info = button.nextElementSibling;
      info.classList.toggle("hidden");
    }
  </script>
</body>
</html>
